tests:
  - name: list home ok
    input:
      server: fs.introspect
      tool: list
      params: { path: "$HOME/**", glob: true, total_bytes: 0 }
      attestation: { tpm_valid: true, cosign_valid: true }
      signatures: [ { kind: human } ]
      policy: { limits: { bytes_max: 1000000 } }
    expect: { allow: true }
  - name: egress without quorum denied
    input:
      server: egress.proxy
      tool: http
      params: { url: "https://slack.com/api", total_bytes: 10 }
      attestation: { tpm_valid: true, cosign_valid: true }
      signatures: [ ]
      policy: { limits: { bytes_max: 1000000 } }
    expect: { allow: false }
